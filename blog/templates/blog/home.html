{% extends 'blog/spite_base.html' %}
{% load crispy_forms_tags %}
{% load static %}
{% load custom_filters %} 
{% block content %}

<!-- Notifications -->
{% for notification in notifications %}
    {% include 'blog/notification_component.html' with notification=notification %}
{% endfor %}

<div class="home content"> 

    <!-- Mobile Collapsible Shop -->
    <div class="mobile-shop">
        <button class="shop-toggle" hx-get="{% url 'shop' %}" hx-target="#mobile-shop-content" hx-swap="afterbegin">
            --&lt Shop Spite &gt--
        </button>
        <div id="mobile-shop-content" class="shop-content">
        </div>
    </div>

	<div class="cta">
        <p>Tired of biting your tongue? </p>
        <button class="post-button" id="post-button">
            <p class="post-button-text"> --&lt Write for Spite! &gt-- </p>
        </button>
    </div>

    <div class="flexbox">
        <div class="text-content">
            <h3>How Spite Started</h3>
            <div class="text-box">
                <p>In my capacity as a <b>digital visionary</b>, I was recently hired by a <b>notorious alt-lit figure</b> to help create a new <b>online periodical</b>.</p>
            </div>
            <div class="center-box">
                <em>
                Another tool to divide us. A cesspool in the guise of a sanctuary.
                </em>
            </div>
        </div>
        <div class="image-content">
            <div class="image-container">
                <div class="shadow-container">
                    <div class="hero-image" role="img" aria-label="Alt Lit Meme Image"></div>

                    <div class="shadow"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="mb-4 flexbox">
        <div class="text-content">
            <h3>Fighting The System</h3>
            <div class="text-box">
                <p>Despite my misgivings <b>I worked hard</b> until this individual conspired to <b>hoard the literary clout for himself</b>. I only had one question.</p>
                <div class="center-box">
                    <h2 class="center-highlight">“HOW CAN I FIGHT BACK?”</h2>
                </div>
            </div>
        </div>
        <div class="image-content">
            <div class="image-container">
                <img :hover src="{% static 'media/spitemagazine.gif' %}" alt="Spite Meme Image" loading="lazy">
            </div>
        </div>
    </div>
    <div class="ml-4 outlined-box">
		<p>My only choice is to create my own online publication. I have playfully dubbed it <em>Spite</em>.</p>
		<p><em>Anyone can write for Spite.</em></p>
    </div>
    {% if not ip_has_submitted %}
        <div id="list-submission">
            <label for="user-input">Enter a NAME onto the INTERESTING LIST</label><br>
            <input type="text" id="user-input" />
            <button onclick="saveInput()">Submit</button>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block highlight %}
{% endblock %}

{% block form %}
{% endblock %}

{% block ai_chat %}
    {% include 'blog/partials/ai_chat_component.html' %}
{% endblock %}

{% block feed %}
    {% include 'blog/feed.html' with home=True posts=posts%}
    
    <!-- Loading indicator at bottom of post list -->
    <div id="loading-indicator" style="display: none; text-align: center; padding: 20px; background: #f8f9fa; border-top: 1px solid #dee2e6;">
        <div class="loading-spinner" style="display: inline-block; width: 30px; height: 30px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <div style="margin-top: 15px; color: #666; font-weight: 500;">...</div>
    </div>
{% endblock %}

{% block tail %}

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<!-- Load fallback script for non-HTMX browsers -->
{% if posts_has_next %}
<script src="{% static 'js/infinite-scroll.js' %}"></script>
{% endif %}

{% endblock %}

{% block page_scripts %}
<script type="module" src="{% static 'js/ragbot_chat.js' %}" defer></script>
{% endblock %}
